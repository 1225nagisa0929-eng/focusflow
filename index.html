<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nudge - ADHD-friendly focus timer designed for neurodivergent minds. Stay focused with gentle reminders and flexible work sessions.">
    <meta name="theme-color" content="#6366f1">
    <title>Nudge - ADHD-Friendly Focus Timer</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="apple-touch-icon" href="assets/icon-192.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app" class="app-container">
        <!-- Navigation -->
        <nav class="nav">
            <div class="nav-brand">
                <span class="brand-name">Nudge</span>
            </div>
            <div class="nav-links">
                <a href="#features" class="nav-link">Features</a>
                <a href="#pricing" class="nav-link">Pricing</a>
                <button id="upgrade-btn" class="btn btn-primary btn-small">Upgrade to Pro</button>
                <button id="login-btn" class="btn btn-ghost btn-small">Login</button>
                <!-- User Menu (shown when logged in) -->
                <div id="user-menu" class="user-menu hidden">
                    <button class="user-menu-trigger" id="user-menu-trigger">
                        <span id="user-avatar" class="user-avatar"></span>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <span id="user-email" class="user-email"></span>
                        <hr>
                        <button id="logout-btn" class="dropdown-item">Sign Out</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero" id="hero">
            <div class="hero-content">
                <span class="badge">Made for ADHD minds</span>
                <h1>Focus Without the Frustration</h1>
                <p class="hero-subtitle">A timer that actually works with your brain, not against it. Flexible sessions, gentle transitions, and zero guilt.</p>
                <button id="start-hero-btn" class="btn btn-primary btn-large">Start Focusing Now</button>
                <p class="hero-note">Free forever ‚Ä¢ No account needed ‚Ä¢ Works offline</p>
            </div>
        </section>

        <!-- Timer Section -->
        <section class="timer-section" id="timer-section" style="display: none;">
            <div class="timer-container">
                <!-- Mode Indicator -->
                <div class="mode-indicator">
                    <span id="mode-badge" class="mode-badge focus">Focus Time</span>
                    <span id="session-count" class="session-count">Session 1 of 4</span>
                </div>

                <!-- Timer Display -->
                <div class="timer-display">
                    <div class="timer-ring">
                        <svg class="progress-ring" viewBox="0 0 200 200">
                            <circle class="progress-ring-bg" cx="100" cy="100" r="90"/>
                            <circle id="progress-circle" class="progress-ring-circle" cx="100" cy="100" r="90"/>
                        </svg>
                        <div class="timer-text">
                            <span id="timer-minutes" class="timer-digits">25</span>
                            <span class="timer-separator">:</span>
                            <span id="timer-seconds" class="timer-digits">00</span>
                        </div>
                    </div>
                </div>

                <!-- ADHD-Friendly Controls -->
                <div class="timer-controls">
                    <button id="start-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">‚ñ∂</span>
                        Start Focus
                    </button>
                    <button id="pause-btn" class="btn btn-secondary btn-large" style="display: none;">
                        <span class="btn-icon">‚è∏</span>
                        Pause
                    </button>
                    <div class="timer-controls-secondary">
                        <button id="skip-btn" class="btn btn-ghost">
                            Skip to Break ‚Üí
                        </button>
                        <button id="stuck-btn" class="btn btn-stuck">
                            I'm stuck...
                        </button>
                    </div>
                </div>

                <!-- Quick Adjustments (ADHD Feature) -->
                <div class="quick-adjust">
                    <p class="adjust-label">Need more or less time? No problem!</p>
                    <div class="adjust-buttons">
                        <button class="adjust-btn" data-adjust="-5">-5 min</button>
                        <button class="adjust-btn" data-adjust="-1">-1 min</button>
                        <button class="adjust-btn" data-adjust="+1">+1 min</button>
                        <button class="adjust-btn" data-adjust="+5">+5 min</button>
                    </div>
                </div>

                <!-- Current Task (Optional) -->
                <div class="current-task">
                    <input type="text" id="task-input" placeholder="What are you working on? (optional)" maxlength="100">
                </div>

                <!-- Motivation Messages -->
                <div id="motivation-message" class="motivation-message">
                    You've got this! One moment at a time.
                </div>

                <!-- AI Encouragement Message -->
                <div id="ai-message" class="ai-message">
                    <div class="ai-message-bubble">
                        <span class="ai-label">AI Encouragement</span>
                        <p id="ai-message-text">ü§ñ Enter a task and start!</p>
                    </div>
                </div>
            </div>

            <!-- Sidebar Stats -->
            <aside class="stats-sidebar">
                <h3>Today's Progress</h3>
                <div class="stat-card">
                    <span class="stat-value" id="total-focus-time">0</span>
                    <span class="stat-label">minutes focused</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="completed-sessions">0</span>
                    <span class="stat-label">sessions completed</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="current-streak">0</span>
                    <span class="stat-label">day streak üî•</span>
                </div>

                <!-- Pro Feature Teaser -->
                <div class="pro-teaser" id="pro-teaser">
                    <h4>‚ú® Pro Features</h4>
                    <ul>
                        <li>üìä Weekly focus reports</li>
                        <li>üéµ Custom ambient sounds</li>
                        <li>üéØ Focus goals & reminders</li>
                        <li>üåô Dark mode</li>
                        <li>üì± Sync across devices</li>
                    </ul>
                    <button id="upgrade-sidebar-btn" class="btn btn-accent btn-small">Unlock for $4.99/mo</button>
                </div>
            </aside>
        </section>

        <!-- Features Section -->
        <section class="features" id="features">
            <h2>Built Different, For Different Brains</h2>
            <p class="section-subtitle">Traditional timers don't work for ADHD. We designed Nudge from the ground up for neurodivergent minds.</p>

            <div class="features-grid">
                <div class="feature-card">
                    <span class="feature-icon">‚è±Ô∏è</span>
                    <h3>Flexible Timing</h3>
                    <p>Adjust your timer on the fly. Need 5 more minutes? No problem. Done early? Skip ahead guilt-free.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üîî</span>
                    <h3>Gentle Transitions</h3>
                    <p>No jarring alarms. Soft sounds and visual cues help you transition without startle or frustration.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üí¨</span>
                    <h3>Positive Reinforcement</h3>
                    <p>Encouraging messages that celebrate small wins. Because every focused moment counts.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üéØ</span>
                    <h3>One Task Focus</h3>
                    <p>Optionally set what you're working on. Keeps you anchored when your brain wants to wander.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üìä</span>
                    <h3>Progress, Not Perfection</h3>
                    <p>Track your focus time without judgment. Every minute counts, even incomplete sessions.</p>
                </div>
                <div class="feature-card">
                    <span class="pro-badge">PRO</span>
                    <span class="feature-icon">üßò</span>
                    <h3>Body Doubling Mode</h3>
                    <p>Ambient sounds that simulate a coffee shop or library. You're not alone.</p>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing" id="pricing">
            <h2>Simple, Fair Pricing</h2>
            <p class="section-subtitle">Start free, upgrade when you're ready. Cancel anytime.</p>

            <div class="pricing-cards">
                <div class="pricing-card">
                    <div class="pricing-header">
                        <h3>Free</h3>
                        <div class="price">$0</div>
                        <p>Forever free</p>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì Unlimited focus sessions</li>
                        <li>‚úì Flexible timer adjustments</li>
                        <li>‚úì Daily progress tracking</li>
                        <li>‚úì Gentle transition sounds</li>
                        <li>‚úì Motivational messages</li>
                        <li>‚úì Works offline</li>
                    </ul>
                    <button class="btn btn-secondary btn-large" id="free-plan-btn">Current Plan</button>
                </div>

                <div class="pricing-card featured">
                    <span class="popular-badge">Most Popular</span>
                    <div class="pricing-header">
                        <h3>Pro</h3>
                        <div class="price">$4.99<span>/month</span></div>
                        <p>or $39.99/year (save 33%)</p>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì Everything in Free</li>
                        <li>‚úì <strong>Weekly focus reports</strong></li>
                        <li>‚úì <strong>Custom ambient sounds</strong></li>
                        <li>‚úì <strong>Focus goals & daily reminders</strong></li>
                        <li>‚úì <strong>Dark mode</strong></li>
                        <li>‚úì <strong>Sync across devices</strong></li>
                        <li>‚úì <strong>Priority support</strong></li>
                    </ul>
                    <button class="btn btn-primary btn-large" id="pro-plan-btn">Start 7-Day Free Trial</button>
                </div>
            </div>
        </section>

        <!-- Testimonials -->
        <section class="testimonials">
            <h2>Loved by ADHD Community</h2>
            <div class="testimonial-grid">
                <div class="testimonial-card">
                    <p>"Finally a timer that doesn't make me feel bad for adjusting it. Game changer for my work sessions."</p>
                    <span class="testimonial-author">‚Äî Sarah M., Freelance Designer</span>
                </div>
                <div class="testimonial-card">
                    <p>"The gentle sounds don't trigger my anxiety like other timers. I actually complete sessions now."</p>
                    <span class="testimonial-author">‚Äî Jake R., Software Developer</span>
                </div>
                <div class="testimonial-card">
                    <p>"My therapist recommended a Pomodoro app but they all stressed me out. Nudge is the first one that works."</p>
                    <span class="testimonial-author">‚Äî Emma L., Graduate Student</span>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="faq" id="faq">
            <h2>Questions? We've Got Answers</h2>
            <div class="faq-list">
                <details class="faq-item">
                    <summary>Is Nudge really free?</summary>
                    <p>Yes! The core timer with all ADHD-friendly features is free forever. Pro adds extras like reports, custom sounds, and dark mode.</p>
                </details>
                <details class="faq-item">
                    <summary>Do I need an account?</summary>
                    <p>Nope! You can start using Nudge immediately. Your data is stored locally on your device. Create an account only if you want cloud sync (Pro feature).</p>
                </details>
                <details class="faq-item">
                    <summary>What makes this different from other timers?</summary>
                    <p>Most timers are rigid and punishing. Nudge lets you adjust time on the fly, uses gentle sounds, and celebrates progress over perfection. It's designed by someone with ADHD, for people with ADHD.</p>
                </details>
                <details class="faq-item">
                    <summary>Can I use it offline?</summary>
                    <p>Yes! Install it as an app on your phone or computer and it works without internet.</p>
                </details>
                <details class="faq-item">
                    <summary>Can I cancel my Pro subscription anytime?</summary>
                    <p>Absolutely. No questions asked, no hoops to jump through. Cancel with one click.</p>
                </details>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta">
            <h2>Ready to Focus Your Way?</h2>
            <p>Join thousands of neurodivergent thinkers who found their flow.</p>
            <button id="cta-start-btn" class="btn btn-primary btn-large">Start Focusing ‚Äî It's Free</button>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <span class="brand-name">Nudge</span>
                </div>
                <div class="footer-links">
                    <a href="#features">Features</a>
                    <a href="#pricing">Pricing</a>
                    <a href="#faq">FAQ</a>
                    <a href="mailto:support@nudge.app">Contact</a>
                </div>
                <p class="footer-copy">¬© 2026 Nudge. Made with üíú for ADHD minds.</p>
            </div>
        </footer>

        <!-- Auth Modal -->
        <div id="auth-modal" class="modal auth-modal">
            <div class="modal-content auth-modal-content">
                <button class="modal-close" id="auth-modal-close">√ó</button>
                <h2>Welcome to Nudge</h2>
                <p class="modal-subtitle">Sign in to sync your progress and unlock Pro features</p>

                <div id="auth-message" class="auth-message hidden"></div>

                <!-- Google Sign In -->
                <button id="google-login-btn" class="btn btn-google btn-large btn-full">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                        <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                        <path d="M9.003 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332A8.997 8.997 0 009.003 18z" fill="#34A853"/>
                        <path d="M3.964 10.712A5.41 5.41 0 013.682 9c0-.593.102-1.17.282-1.71V4.958H.96A8.996 8.996 0 000 9c0 1.452.348 2.827.96 4.042l3.004-2.33z" fill="#FBBC05"/>
                        <path d="M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.428 0 9.002 0A8.997 8.997 0 00.96 4.958l3.004 2.332c.708-2.127 2.692-3.71 5.036-3.71z" fill="#EA4335"/>
                    </svg>
                    Continue with Google
                </button>

                <div class="auth-divider">
                    <span>or</span>
                </div>

                <!-- Magic Link -->
                <form id="magic-link-form" class="magic-link-form">
                    <input type="email" id="magic-link-email" placeholder="Enter your email" required>
                    <button type="submit" id="magic-link-btn" class="btn btn-secondary btn-large btn-full">
                        Send Magic Link
                    </button>
                </form>

                <p class="auth-note">
                    No password needed. We'll send you a secure login link.
                </p>
            </div>
        </div>

        <!-- Payment Modal -->
        <div id="payment-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <button class="modal-close" id="modal-close">√ó</button>
                <h2>Upgrade to Pro</h2>
                <p class="modal-subtitle">Start your 7-day free trial</p>

                <!-- Login prompt for non-authenticated users -->
                <div id="payment-login-prompt" class="payment-login-prompt hidden">
                    <p>Please sign in first to upgrade to Pro</p>
                    <button id="payment-login-btn" class="btn btn-primary btn-large btn-full">
                        Sign In to Continue
                    </button>
                </div>

                <!-- Plan selector for authenticated users -->
                <div id="payment-plans" class="plan-selector">
                    <label class="plan-option">
                        <input type="radio" name="plan" value="monthly" checked>
                        <span class="plan-details">
                            <span class="plan-name">Monthly</span>
                            <span class="plan-price">$4.99/month</span>
                        </span>
                    </label>
                    <label class="plan-option recommended">
                        <input type="radio" name="plan" value="yearly">
                        <span class="plan-details">
                            <span class="plan-name">Yearly <span class="save-badge">Save 33%</span></span>
                            <span class="plan-price">$39.99/year</span>
                        </span>
                    </label>
                </div>

                <button id="submit-payment" class="btn btn-primary btn-large btn-full">
                    Start Free Trial
                </button>

                <p class="payment-note">
                    üîí Secure payment by Stripe<br>
                    Cancel anytime during trial. No charge until trial ends.
                </p>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="focus-start-sound" preload="auto">
        <source src="sounds/focus-start.mp3" type="audio/mpeg">
    </audio>
    <audio id="break-start-sound" preload="auto">
        <source src="sounds/break-start.mp3" type="audio/mpeg">
    </audio>
    <audio id="session-complete-sound" preload="auto">
        <source src="sounds/complete.mp3" type="audio/mpeg">
    </audio>

    <!-- Environment Variables (injected by Vercel) -->
    <script>
        // These will be replaced by Vercel with actual environment variables
        window.SUPABASE_URL = '%VITE_SUPABASE_URL%' !== '%' + 'VITE_SUPABASE_URL%' ? '%VITE_SUPABASE_URL%' : '';
        window.SUPABASE_ANON_KEY = '%VITE_SUPABASE_ANON_KEY%' !== '%' + 'VITE_SUPABASE_ANON_KEY%' ? '%VITE_SUPABASE_ANON_KEY%' : '';
        window.STRIPE_PUBLISHABLE_KEY = '%VITE_STRIPE_PUBLISHABLE_KEY%' !== '%' + 'VITE_STRIPE_PUBLISHABLE_KEY%' ? '%VITE_STRIPE_PUBLISHABLE_KEY%' : '';
    </script>

    <!-- Scripts -->
    <script src="https://js.stripe.com/v3/"></script>
    <script src="js/storage.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script src="js/timer.js"></script>
    <script type="module" src="js/payment.js"></script>
    <script type="module" src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
